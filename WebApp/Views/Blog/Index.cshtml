@model ShopGame.Service.Model.ShopGameResultModel<ShopGame.Service.Model.ViewModel.BlogViewModel>
@{
    var data = Model.Results;
    var pageSize = Model.PageSize;
    var pageNumber = Model.PageNumber;
    var pageCount = Model.PageCount;
    var types = ViewBag.BlogTypes;
}
@{
    ViewData["Title"] = "Blog";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section Scripts{
    <script>

        function ChangePageNumber() {
            $('.pagination li a').on('click', function (e) {
                let val = $(this).attr('data-index')??"";
                let search = $("#search-blog").val();
                submitData.pageNumber = val;
                location.href = "/blog?pageNumber=" + val + "&search=" + search;
            })
        }
        ChangePageNumber();


        function Search() {
            let search = $("#search-blog").val();
            let val = $(this).attr('data-index') ?? "";
            location.href = "/blog?pageNumber=" + val + "&search=" + search;
        }
        $("#search-blog").on('keypress', function (e) {
            if (e.which == 13) {
                Search();
            }
        });
    </script>

}

<!-- page content -->
<section id="page-content">
    <div class="container bg-container mt-3 p-3">
        <div class="row">
            <div class="col-md-6">
                <h4>BLOG TIN TỨC</h4>
            </div>
            <div class="col-md-6">
                <div class="text-right">
                    <span>Trang chủ </span> / <span>Blog tin tức</span>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- blog-list -->
<section id="blog-list" class="py-5">
    <div class="container bg-container p-3">
        <div class="box-input-select">
                <div class="form-group row">
                    <div class="col-sm-6">
                        <input class="form-control" id="search-blog" value="@ViewBag.Search" type="search" placeholder="Nhập từ khóa..." aria-label="Search">
                    </div>
                    <div class="col-sm-6">
                        <button class="btn btn-primary  mr-sm-2" type="button"onclick="Search()">Tìm kiếm</button>
                        <a class="btn btn-danger"href="/blog">Tất cả</a>
                    </div>
                </div>
        </div>
        <div class="row">
            <div class="col-lg-9">
                @foreach (var item in data)
                {
                    <div class="box-blog mb-2">
                        <div class="row">
                            <div class="col-4">
                                <div class="box-blog-image">
                                    <a href="/blog/detail?@item.Id"><img class="w-100" src="@item.Image" alt="@item.MetaTitle"></a>
                                </div>
                            </div>
                            <div class="col-8">
                                <div class="box-blog-content pt-2">
                                    <a href="/blog/detail?Id=@item.Id">
                                        <strong>
                                            @item.Name
                                        </strong>
                                    </a>
                                    <p>
                                        <i class="fas fa-calendar-alt"></i>
                                        @item.CreatedDate.ToString("dd/MM/yyyy")
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                }

            </div>
            <partial name="../Blog/_MenuRight" model="types" />

        </div>
        <div class="pagination-container">
            <ul class="pagination">
                @if (pageCount <= 4)
                {
                    for (int index = 1; index <= pageCount; index++)
                    {
                        if (index == pageNumber)
                        {
                            <li class="active"><a data-index="@index">@index</a></li>
                        }
                        else
                        {
                            <li><a data-index="@index">@index</a></li>
                        }
                    }
                }
                else
                {
                    if (pageNumber <= 2)
                    {
                        for (int index = 1; index <= 4; index++)
                        {
                            if (index == pageNumber)
                            {
                                <li class="active"><a data-index="@index">@index</a></li>
                            }
                            else
                            {
                                <li><a data-index="@index">@index</a></li>
                            }
                        }
                        <li><a class="nextPage" data-index="@pageCount"><i class="fas fa-chevron-right"></i></a></li>
                    }
                    else if (pageNumber >= pageCount - 2)
                    {
                        <li><a class="prevPage" data-index="1"><i class="fas fa-chevron-left"></i></a></li>

                        for (int index = pageCount - 3; index <= pageCount; index++)
                        {
                            if (index == pageNumber)
                            {
                                <li class="active"><a data-index="@index">@index</a></li>
                            }
                            else
                            {
                                <li><a data-index="@index">@index</a></li>
                            }
                        }
                    }
                    else
                    {
                        <li><a class="prevPage" data-index="1"><i class="fas fa-chevron-left"></i></a></li>
                        for (int index = pageNumber - 1; index <= pageNumber + 2; index++)
                        {
                            if (index == pageNumber)
                            {
                                <li class="active"><a data-index="@index">@index</a></li>
                            }
                            else
                            {
                                <li><a data-index="@index">@index</a></li>
                            }
                        }
                        <li><a class="nextPage" data-index="@pageCount"><i class="fas fa-chevron-right"></i></a></li>
                    }
                }

            </ul>
        </div>

    </div>
</section>

